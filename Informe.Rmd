---
title: "Seguimiento a largo plazo de reptiles en Doñana 2005-2021"
author: "Sergio Picó Jordá y María Hurtado de Mendoza Romo"
output: html_document
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE)

# Cargar los paquetes necesarios
library(readr)
library(tidyr)
library(dplyr)
library(terra)
library(stringr)

```

# Seguimiento a largo plazo de reptiles en Doñana 2005-2021

## Introducción

El monitoreo anual de reptiles en el Espacio Natural de Doñana (END) se inició en el año 2005 con el objetivo de detectar cambios y tendencias en las poblaciones de estos animales.

El monitoreo se hace anualmente en primavera y otoño realizando 7 transectos en distintos hábitats, durante los que se registran todas las observaciones de las especie de interés.

## Distribución espacial de las observaciones

```{r prepare_data, include = FALSE}

# Cargar los datos
data <- readr::read_delim("data/donana_reptiles.csv", delim = "\t")

# Seleccionar las variables necesarias
data <- data %>% dplyr::select(occurrenceID, scientificName, individualCount, decimalLatitude, decimalLongitude, day, month)

# Quitar observaciones no identificadas a nivel de especie
data <- data %>% filter(scientificName != "Chordata")

# Acortar nombres científicos
data$scientificName[data$scientificName == "Podarcis carbonelli (Perez Mellado, 1981)"] <- "Podarcis carbonelli"
data$scientificName[data$scientificName == "Podarcis carbonelli Perez Mellado, 1981"] <- "Podarcis carbonelli"
data$scientificName[data$scientificName == "Psammodromus algirus (Linnaeus, 1758)"] <- "Psammodromus algirus"
data$scientificName[data$scientificName == "Tarentola mauritanica (Linnaeus, 1758)"] <- "Tarentola mauritanica"
data$scientificName[data$scientificName == "Acanthodactylus erythrurus (Schinz, 1833)"] <- "Acanthodactylus erythrurus"
data$scientificName[data$scientificName == "Testudo graeca (Linnaeus, 1758)"] <- "Testudo_graeca"
data$scientificName[data$scientificName == "Testudo graeca Linnaeus, 1758"] <- "Testudo_graeca"
data$scientificName[data$scientificName == "Psammodromus occidentalis (Fitze, Gonzalez-Jimena, San Jose, San Mauro & Zardoya, 2012)"] <- "Psammodromus occidentalis"
data$scientificName[data$scientificName == "Psammodromus occidentalis Fitze, Gonzalez-Jimena, San-Jose, San Mauro & Zardoya, 2012"] <- "Psammodromus occidentalis"
data$scientificName[data$scientificName == "Timon lepidus (Daudin, 1802)"] <- "Timon lepidus"
data$scientificName[data$scientificName == "Hemorrhois hippocrepis (Linnaeus, 1758)"] <- "Hemorrhois hippocrepis"
data$scientificName[data$scientificName == "Chalcides striatus (Cuvier, 1829)"] <- "Chalcides striatus"
data$scientificName[data$scientificName == "Malpolon monspessulanus (Hermann, 1804)"] <- "Malpolon monspessulanus"
```

```{r mapa, results = TRUE, warning = FALSE}

# Crear un objeto espacial con las coordenadas de
# las observaciones
obs <- terra::vect(data, geom = c(x = "decimalLongitude", y = "decimalLatitude"))

# Crear mapa interactivo con leaflet
terra::plet(obs, col = "#003366")
```
Figura 1. Mapa de las observaciones registradas